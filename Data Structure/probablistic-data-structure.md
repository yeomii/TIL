# 확률적 자료구조

## 문제
* 웹 페이지의 UV (unique visitor) 를 정확히 계산하려면?
    * 해당 시간의 방문 로그를 모두 확인하거나
    * 서버에서 HashSet 과 같은 자료구조를 두어 파악해야 한다
* 위 방법들은 실시간 처리가 어렵거나 메모리를 너무 많이 사용한다는 단점이 있다
* 실시간으로 메모리를 매우 적게 사용해 근사값을 구하는 것이 더 유용할 수 있다
    * 근사값을 구하는 방식을 추정(estimation) 이라고 한다
* 확률적 자료구조를 사용하여 메모리를 적게 사용하면서 실시간으로 추정할 수 있다

## 대표적인 추정 연산
* HyperLogLog
    * Cardinality
    * 중복 허용 안하는 집합에서 요소 개수
* Bloom Filter
    * Membership Query
    * 특정 요소가 집합에 포함되는지 판단
* Count-min Sketch
    * Top-K/Range Frequency
    * 중복을 포함하는 집합엣 특정 요소가 해당 집합에 몇개나 포함되어있는지 판단
* 위 자료구조들은 해시 함수를 사용하여 데이터 유일성 판단에 대해 확률적으로 접근한다

## hyperloglog
* [참고자료](http://d2.naver.com/helloworld/711301)
* 상대 오차 범위
    * 1.04 / sqrt(m)
    * m 은 HyperLogLog 에서 사용하는 레지스터(데이터버킷) 의 개수
* cardinality 를 N 이라 할 때, 각 레지스터 크기는 log2 (log2 (N)) + O(1) 이다
* h(x) 
    * 해시함수
* p(x)
    * 정수형 x를 2진수로 표현했을때 MSB 로부터 가장 처음 나타나는 1의 위치 반환
* M[m] m = 2^b
    * M 은 m 개의 레지스터(데이터 버킷, 배열)
    * m 값을 계산할 때 사용하는 b 는 자연수
    * M 의 인덱스는 0 부터 시작하고 각 레지스터는 음수로 초기화
* d_u(x) 
    * 입력값 x 에 대하여 상위 b 비트를 추출
* d_l(x)
    * 입력값 x 에 대하여 상위 b 비트 이후를 추출
* 절차
    * 입력 값 v 에 대하여 x = h(v), j = d_u(x), w = d_l(x)
    * M[j] = Max(M[j], p(w))

## Theta sketch
* TODO